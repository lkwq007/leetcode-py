class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        disjoint=[-1]*len(graph)
        virus=[0]*len(graph)
        total=len(graph)
        def find(x):
            ret=x
            while disjoint[ret]>=0:
                ret=disjoint[ret]
            while disjoint[x]>=0:
                tmp=disjoint[x]
                disjoint[x]=ret
                x=tmp
            return ret
        for idx in initial:
            virus[idx]=1
        for i in range(total):
            for j in range(i+1,total):
                if graph[i][j]==1:
                    idx1=find(i)
                    idx2=find(j)
                    if idx1!=idx2:
                        disjoint[idx1]+=disjoint[idx2]
                        disjoint[idx2]=idx1
                        virus[idx1]+=virus[idx2]
        ret=-1
        flag=False
        for node in sorted(initial):
            idx=find(node)
            if ret==-1 and virus[idx]>0:
                ret=node
            if virus[idx]==1:
                if ret==-1 or virus[find(ret)]>1 or virus[find(ret)]==1 and disjoint[idx]<disjoint[find(ret)]:
                    ret=node
                flag=True
        return ret
